<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FancyDialogs Editor</title>

  <!-- Material Symbols Outlined (M3 icon font) -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200">

  <!-- Vite entry point — handles all CSS + M3 component imports -->
  <script type="module" src="/src/main.js"></script>
</head>
<body>

  <!-- ═══════════════════════════════ Preloader ═══════════════════════════════ -->
  <div class="preloader" id="preloader">
    <md-circular-progress indeterminate class="preloader-spinner"></md-circular-progress>
  </div>

  <!-- ═══════════════════════════════ Navigation Rail ════════════════════════════ -->
  <nav class="nav-rail" role="navigation" aria-label="Main navigation">
    <div class="nav-rail-header">
      <img src="/favicon.ico" class="nav-rail-favicon" alt="FancyDialogs Editor">
      <span class="m3-badge">BETA</span>
    </div>

    <div class="nav-rail-items">
      <button class="nav-rail-item active" id="nav-editor" role="tab" aria-selected="true">
        <span class="nav-rail-icon">
          <span class="material-symbols-outlined" aria-hidden="true">settings</span>
        </span>
        <span class="nav-rail-label">Editor</span>
      </button>
      <button class="nav-rail-item" id="nav-instructions" role="tab" aria-selected="false">
        <span class="nav-rail-icon">
          <span class="material-symbols-outlined" aria-hidden="true">help</span>
        </span>
        <span class="nav-rail-label">Instructions</span>
      </button>
    </div>

    <div class="nav-rail-footer">
      <md-icon-button id="theme-toggle" aria-label="Toggle theme">
        <span class="material-symbols-outlined">light_mode</span>
      </md-icon-button>
    </div>
  </nav>

  <!-- ═══════════════════════════════ App Content ═══════════════════════════════ -->
  <div class="app-content">

  <!-- ═══════════════════════════════ Main Container ═══════════════════════════ -->
  <div class="minecraft-container">

    <!-- ─────────────────────── Editor Page ─────────────────────── -->
    <div id="editor-page" class="page active">
      <div class="main-grid">

        <!-- ── Editor Panel ── -->
        <div class="surface-card">
          <div class="panel-title">
            <span class="material-symbols-outlined" aria-hidden="true">settings</span>
            Dialog Editor
          </div>

          <!-- Main editor tabs -->
          <md-tabs id="editor-tabs" aria-label="Dialog configuration sections">
            <md-primary-tab>Basic</md-primary-tab>
            <md-primary-tab>Body</md-primary-tab>
            <md-primary-tab>Inputs</md-primary-tab>
            <md-primary-tab>Buttons</md-primary-tab>
          </md-tabs>

          <!-- ── Basic Tab ── -->
          <div id="basic-panel" class="tab-panel">
            <div class="m3-info-surface">
              <span class="material-symbols-outlined" aria-hidden="true">lightbulb</span>
              See <a href="#" id="go-to-instructions">instructions</a> for guidance
            </div>

            <md-outlined-text-field
              id="dialog-id"
              label="Dialog ID"
              value="my_dialog"
              placeholder="my_dialog"
              supporting-text="Unique identifier — lowercase letters, numbers, underscores"
              aria-label="Dialog ID">
            </md-outlined-text-field>

            <md-outlined-text-field
              id="dialog-title"
              label="Title"
              value="&lt;b&gt;&lt;color:#ff7300&gt;My Dialog&lt;/color&gt;&lt;/b&gt;"
              placeholder="&lt;b&gt;&lt;color:#ff7300&gt;Title&lt;/color&gt;&lt;/b&gt;"
              supporting-text="MiniMessage formatting supported"
              aria-label="Dialog title">
            </md-outlined-text-field>

            <div class="checkbox-row">
              <md-checkbox id="can-close-escape" checked aria-label="Allow closing dialog with ESC key"></md-checkbox>
              <label class="field-label" for="can-close-escape">Close with ESC</label>
            </div>
          </div>

          <!-- ── Body Tab ── -->
          <div id="body-panel" class="tab-panel hidden">
            <div class="m3-info-surface">
              <span class="material-symbols-outlined" aria-hidden="true">chat</span>
              Each line appears in the dialog body
            </div>

            <div id="body-lines-container"></div>

            <md-filled-button id="add-body-line-btn" style="width:100%">
              + Add Line
            </md-filled-button>
          </div>

          <!-- ── Inputs Tab ── -->
          <div id="inputs-panel" class="tab-panel hidden">
            <md-tabs id="inputs-tabs" class="sub-tabs" aria-label="Input type selection">
              <md-secondary-tab>Text</md-secondary-tab>
              <md-secondary-tab>Dropdown</md-secondary-tab>
              <md-secondary-tab>Checkbox</md-secondary-tab>
            </md-tabs>

            <div id="textfields-panel" class="sub-panel">
              <div id="textfields-container"></div>
              <md-filled-button id="add-textfield-btn" style="width:100%;margin-top:0.5rem">
                + Add Text Field
              </md-filled-button>
            </div>

            <div id="selects-panel" class="sub-panel hidden">
              <div id="selects-container"></div>
              <md-filled-button id="add-select-btn" style="width:100%;margin-top:0.5rem">
                + Add Dropdown
              </md-filled-button>
            </div>

            <div id="checkboxes-panel" class="sub-panel hidden">
              <div id="checkboxes-container"></div>
              <md-filled-button id="add-checkbox-btn" style="width:100%;margin-top:0.5rem">
                + Add Checkbox
              </md-filled-button>
            </div>
          </div>

          <!-- ── Buttons Tab ── -->
          <div id="buttons-panel" class="tab-panel hidden">
            <div class="m3-info-surface">
              <span class="material-symbols-outlined" aria-hidden="true">radio_button_checked</span>
              Clickable buttons with actions
            </div>

            <div id="buttons-container"></div>

            <md-filled-button id="add-button-btn" style="width:100%">
              + Add Button
            </md-filled-button>
          </div>

          <!-- ── Action Bar ── -->
          <div class="button-row">
            <div class="history-controls">
              <md-icon-button id="undo-btn" title="Undo (Ctrl+Z)" disabled aria-label="Undo">
                <span class="material-symbols-outlined">undo</span>
              </md-icon-button>
              <md-icon-button id="redo-btn" title="Redo (Ctrl+Shift+Z)" disabled aria-label="Redo">
                <span class="material-symbols-outlined">redo</span>
              </md-icon-button>
            </div>

            <md-filled-tonal-button id="download-btn">
              <span class="material-symbols-outlined" slot="icon">save</span>
              Download
            </md-filled-tonal-button>

            <md-filled-tonal-button id="presets-btn">
              <span class="material-symbols-outlined" slot="icon">view_module</span>
              Presets
            </md-filled-tonal-button>

            <md-filled-tonal-button id="import-btn">
              <span class="material-symbols-outlined" slot="icon">folder_open</span>
              Import
            </md-filled-tonal-button>

            <md-filled-tonal-button id="reset-btn" class="danger-tonal-btn">
              <span class="material-symbols-outlined" slot="icon">delete</span>
              Reset
            </md-filled-tonal-button>

            <input type="file" id="file-input" accept=".json" style="display:none">
          </div>
        </div><!-- /surface-card editor -->

        <!-- ── Preview Panel ── -->
        <div class="surface-card">
          <div class="panel-title">
            <span class="material-symbols-outlined" aria-hidden="true">visibility</span>
            Live Preview
          </div>

          <!-- Preview tabs -->
          <md-tabs id="preview-tabs" aria-label="Preview modes">
            <md-primary-tab>Visual</md-primary-tab>
            <md-primary-tab>Code</md-primary-tab>
          </md-tabs>

          <!-- Visual preview panel — Minecraft-styled, not M3 -->
          <div id="visual-preview-panel" class="tab-panel">
            <div class="preview-wrapper">
              <div class="preview-background" aria-hidden="true"></div>
              <div class="preview-dialog" id="preview-container" role="img" aria-label="Dialog visual preview"></div>
            </div>

            <div class="preview-console" id="preview-console" aria-live="polite">
              <div class="preview-console-header">Console Output</div>
              <div class="preview-console-content" id="preview-console-content">
                <div style="color:var(--md-sys-color-outline);font-style:italic">
                  Click a button to see what actions it will execute…
                </div>
              </div>
            </div>
          </div>

          <!-- Code preview panel -->
          <div id="code-preview-panel" class="tab-panel hidden">
            <div class="copy-btn-wrapper">
              <md-icon-button id="copy-json-btn" aria-label="Copy JSON to clipboard" title="Copy JSON">
                <span class="material-symbols-outlined">content_copy</span>
              </md-icon-button>
              <div class="code-preview" id="json-preview" role="textbox" aria-readonly="true" aria-label="JSON output"></div>
            </div>
          </div>
        </div><!-- /surface-card preview -->

      </div><!-- /main-grid -->

      <div class="github-link">
        If you find any issues or have feature ideas, please report them on
        <a href="https://github.com/TSERATO/FancyDialogs-Web-Editor" target="_blank" rel="noopener">GitHub</a>
      </div>
    </div><!-- /editor-page -->

    <!-- ─────────────────── Instructions Page ─────────────────── -->
    <div id="instructions-page" class="page">
      <div class="instructions-container">

        <div class="instruction-section">
          <div class="section-header">
            <span class="material-symbols-outlined" aria-hidden="true">rocket_launch</span>
            <h2>Getting Started</h2>
          </div>
          <p>The FancyDialogs Editor helps you create interactive dialog interfaces for Minecraft 1.21.6+ without writing JSON manually.</p>
        </div>

        <div class="instruction-section">
          <div class="section-header">
            <span class="material-symbols-outlined" aria-hidden="true">list</span>
            <h2>Dialog Creation Workflow</h2>
          </div>
          <div class="workflow-steps">
            <div class="workflow-step">
              <div class="step-number">1</div>
              <div class="step-content">
                <h3>Basic Information Setup</h3>
                <p>Enter a unique dialog ID, add formatted titles, and toggle ESC-to-close functionality.</p>
              </div>
            </div>
            <div class="workflow-step">
              <div class="step-number">2</div>
              <div class="step-content">
                <h3>Body Text Addition</h3>
                <p>Add multiple text lines with MiniMessage formatting support.</p>
              </div>
            </div>
            <div class="workflow-step">
              <div class="step-number">3</div>
              <div class="step-content">
                <h3>Input Configuration</h3>
                <p>Add text fields, dropdown menus, and checkboxes for user input.</p>
              </div>
            </div>
            <div class="workflow-step">
              <div class="step-number">4</div>
              <div class="step-content">
                <h3>Button Creation</h3>
                <p>Every dialog requires at least one button with customizable labels and actions.</p>
              </div>
            </div>
            <div class="workflow-step">
              <div class="step-number">5</div>
              <div class="step-content">
                <h3>Export</h3>
                <p>Download the completed dialog as a JSON file for your FancyDialogs plugin folder.</p>
              </div>
            </div>
          </div>
        </div>

        <div class="instruction-section">
          <div class="section-header">
            <span class="material-symbols-outlined" aria-hidden="true">palette</span>
            <h2>Text Formatting</h2>
          </div>
          <p>The editor supports MiniMessage format for rich text styling:</p>
          <div class="example-box">
            <code>&lt;b&gt;Bold Text&lt;/b&gt;</code>
            <code>&lt;color:#ff7300&gt;Colored Text&lt;/color&gt;</code>
            <code>&lt;u&gt;Underlined&lt;/u&gt;</code>
          </div>
        </div>

        <div class="instruction-section">
          <div class="section-header">
            <span class="material-symbols-outlined" aria-hidden="true">input</span>
            <h2>Input Components</h2>
          </div>
          <div class="component-grid">
            <div class="component-card">
              <span class="material-symbols-outlined component-icon" aria-hidden="true">text_fields</span>
              <h3>Text Fields</h3>
              <p>Single or multi-line input fields with character limits and placeholders.</p>
            </div>
            <div class="component-card">
              <span class="material-symbols-outlined component-icon" aria-hidden="true">arrow_drop_down_circle</span>
              <h3>Dropdowns</h3>
              <p>Selection menus with custom options and default values.</p>
            </div>
            <div class="component-card">
              <span class="material-symbols-outlined component-icon" aria-hidden="true">check_box</span>
              <h3>Checkboxes</h3>
              <p>Boolean inputs with true/false values and initial states.</p>
            </div>
          </div>
        </div>

        <div class="instruction-section">
          <div class="section-header">
            <span class="material-symbols-outlined" aria-hidden="true">code</span>
            <h2>Placeholder Integration</h2>
          </div>
          <p>Use PlaceholderAPI and input placeholders in your dialogs:</p>
          <div class="example-box">
            <code>%player_name%</code> — Server placeholders
            <code>{player_name}</code> — Form input values
            <code>%vault_eco_balance%</code> — Plugin placeholders
          </div>
        </div>

        <div class="instruction-section">
          <div class="section-header">
            <span class="material-symbols-outlined" aria-hidden="true">touch_app</span>
            <h2>Button Actions</h2>
          </div>
          <div class="actions-grid">
            <div class="action-badge">
              <span class="material-symbols-outlined" aria-hidden="true">message</span>
              <span>Message</span>
            </div>
            <div class="action-badge">
              <span class="material-symbols-outlined" aria-hidden="true">open_in_new</span>
              <span>Open Dialog</span>
            </div>
            <div class="action-badge">
              <span class="material-symbols-outlined" aria-hidden="true">casino</span>
              <span>Random Dialog</span>
            </div>
            <div class="action-badge">
              <span class="material-symbols-outlined" aria-hidden="true">terminal</span>
              <span>Console Command</span>
            </div>
            <div class="action-badge">
              <span class="material-symbols-outlined" aria-hidden="true">person</span>
              <span>Player Command</span>
            </div>
            <div class="action-badge">
              <span class="material-symbols-outlined" aria-hidden="true">cloud_upload</span>
              <span>Transfer Server</span>
            </div>
          </div>
        </div>

        <div class="instruction-section">
          <div class="section-header">
            <span class="material-symbols-outlined" aria-hidden="true">info</span>
            <h2>Tips &amp; Best Practices</h2>
          </div>
          <div class="tips-list">
            <div class="tip-item">
              <span class="material-symbols-outlined" aria-hidden="true">check_circle</span>
              <p>Use descriptive dialog IDs to easily identify them</p>
            </div>
            <div class="tip-item">
              <span class="material-symbols-outlined" aria-hidden="true">check_circle</span>
              <p>Test your dialogs in-game before deploying to production</p>
            </div>
            <div class="tip-item">
              <span class="material-symbols-outlined" aria-hidden="true">check_circle</span>
              <p>Keep dialog text concise and easy to read</p>
            </div>
            <div class="tip-item">
              <span class="material-symbols-outlined" aria-hidden="true">check_circle</span>
              <p>Use the preset templates as starting points</p>
            </div>
          </div>
        </div>

      </div><!-- /instructions-container -->
    </div><!-- /instructions-page -->

  </div><!-- /minecraft-container -->

  <!-- ═══════════════════════════════ Footer ═══════════════════════════════════ -->
  <footer class="footer" role="contentinfo">
    <div class="footer-wave" aria-hidden="true">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 20" preserveAspectRatio="none">
        <path d="M0,10 C120,20 240,0 360,10 C480,20 600,0 720,10 C840,20 960,0 1080,10 C1200,20 1320,0 1440,10" fill="none" stroke="currentColor" stroke-width="1.5"/>
      </svg>
    </div>

    <div class="footer-main">
      <div class="footer-brand-col">
        <img src="/favicon.ico" class="footer-favicon" alt="FancyDialogs Editor">
        <p class="footer-desc">A visual editor for the FancyDialogs Minecraft plugin. Create, preview, and export dialog configurations without writing JSON.</p>
      </div>

      <div class="footer-links">
        <div class="footer-col">
          <span class="footer-col-heading">Resources</span>
          <a href="https://github.com/TSERATO/FancyDialogs-Web-Editor" target="_blank" rel="noopener" class="footer-link">GitHub</a>
          <a href="https://github.com/TSERATO/FancyDialogs-Web-Editor/issues" target="_blank" rel="noopener" class="footer-link">Report a Bug</a>
        </div>
        <div class="footer-col">
          <span class="footer-col-heading">Contributors</span>
          <a href="https://github.com/TSERATO" target="_blank" rel="noopener" class="footer-link">Alex</a>
          <a href="https://github.com/tolnayeu" target="_blank" rel="noopener" class="footer-link">Barni</a>
        </div>
      </div>
    </div>

    <div class="footer-bottom">
      <span>© 2025 FancyDialogs Editor — made with ♥ by Alex, Barni &amp; contributors.</span>
    </div>
  </footer>

  </div><!-- /app-content -->

  <!-- ═══════════════════════════════ Action Modal ══════════════════════════════ -->
  <md-dialog id="action-modal" aria-labelledby="action-modal-headline">
    <div slot="headline">Add Action</div>

    <div slot="content">
      <md-outlined-select id="action-type" label="Action Type" aria-label="Action type">
        <md-select-option value="message" selected>
          <div slot="headline">Message</div>
        </md-select-option>
        <md-select-option value="open_dialog">
          <div slot="headline">Open Dialog</div>
        </md-select-option>
        <md-select-option value="open_random_dialog">
          <div slot="headline">Random Dialog</div>
        </md-select-option>
        <md-select-option value="console_command">
          <div slot="headline">Console Command</div>
        </md-select-option>
        <md-select-option value="player_command">
          <div slot="headline">Player Command</div>
        </md-select-option>
        <md-select-option value="send_to_server">
          <div slot="headline">Transfer Server</div>
        </md-select-option>
      </md-outlined-select>

      <div id="action-fields"></div>
    </div>

    <div slot="actions">
      <md-text-button id="cancel-action-btn">Cancel</md-text-button>
      <md-filled-tonal-button id="confirm-action-btn">Add Action</md-filled-tonal-button>
    </div>
  </md-dialog>

  <!-- ═══════════════════════════════ Option Modal ══════════════════════════════ -->
  <md-dialog id="option-modal" aria-labelledby="option-modal-headline">
    <div slot="headline">Add Option</div>

    <div slot="content">
      <md-outlined-text-field
        id="option-value"
        label="Value (placeholder)"
        placeholder="red">
      </md-outlined-text-field>

      <md-outlined-text-field
        id="option-display"
        label="Display Text"
        placeholder="&lt;color:red&gt;Red&lt;/color&gt;">
      </md-outlined-text-field>

      <div class="checkbox-row">
        <md-checkbox id="option-initial" aria-label="Set as default selection"></md-checkbox>
        <label class="field-label" for="option-initial">Default Selection</label>
      </div>
    </div>

    <div slot="actions">
      <md-text-button id="cancel-option-btn">Cancel</md-text-button>
      <md-filled-tonal-button id="confirm-option-btn">Add Option</md-filled-tonal-button>
    </div>
  </md-dialog>

  <!-- ═══════════════════════════════ Presets Modal ════════════════════════════ -->
  <md-dialog id="presets-modal" aria-labelledby="presets-modal-headline">
    <div slot="headline">Choose a Preset</div>

    <div slot="content">
      <div class="presets-grid">
        <button class="preset-card" data-preset="welcome" aria-label="Load Welcome preset">
          <span class="material-symbols-outlined preset-icon" aria-hidden="true">waving_hand</span>
          <div class="preset-title">Welcome</div>
          <div class="preset-description">Server welcome dialog with greeting message</div>
        </button>

        <button class="preset-card" data-preset="confirm" aria-label="Load Confirm preset">
          <span class="material-symbols-outlined preset-icon" aria-hidden="true">check_circle</span>
          <div class="preset-title">Confirm</div>
          <div class="preset-description">Confirmation dialog for important actions</div>
        </button>

        <button class="preset-card" data-preset="survey" aria-label="Load Survey preset">
          <span class="material-symbols-outlined preset-icon" aria-hidden="true">poll</span>
          <div class="preset-title">Survey</div>
          <div class="preset-description">Player feedback form with ratings</div>
        </button>

        <button class="preset-card" data-preset="settings" aria-label="Load Settings preset">
          <span class="material-symbols-outlined preset-icon" aria-hidden="true">tune</span>
          <div class="preset-title">Settings</div>
          <div class="preset-description">Configuration dialog with preferences</div>
        </button>

        <button class="preset-card" data-preset="warning" aria-label="Load Warning preset">
          <span class="material-symbols-outlined preset-icon" aria-hidden="true">warning</span>
          <div class="preset-title">Warning</div>
          <div class="preset-description">Critical warning dialog with alert</div>
        </button>
      </div>
    </div>

    <div slot="actions">
      <md-text-button id="cancel-presets-btn">Cancel</md-text-button>
    </div>
  </md-dialog>

  <!-- Vercel Analytics -->
  <script>
    window.va = window.va || function () { (window.vaq = window.vaq || []).push(arguments); };
  </script>
  <script defer src="/_vercel/insights/script.js"></script>

</body>
</html>
